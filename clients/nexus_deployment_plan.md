# Nexus Swarm Deployment Plan
## Nexus Financial Assurance Ltd. - MAaaS Ecosystem

**Generated By:** Prime Orchestrator, Swarm Agency  
**Date:** 2025-12-15  
**Client:** Nexus Financial Assurance Ltd. (FinTech / Audit Services)  
**Target Market:** Finance  
**Status:** MAPPED & READY FOR DEPLOYMENT

---

## A. FINALIZED AGENT INSTANCE IDs AND ROLES

### Agent Registry

| Agent Instance ID | Base Class | Role Name | Specialization | Status |
|-------------------|------------|-----------|----------------|--------|
| `Nexus_PM-{UUID}` | `Agent_ProjectManager` | Audit Workflow Coordinator | Audit Workflow Supervisor | ACTIVE (Contract Signed) |
| `Nexus_Researcher-{UUID}` | `Agent_Researcher` | Junior Data Analyst | Data Ingestion & Normalization | ACTIVE (Contract Signed) |
| `Nexus_Compliance-{UUID}` | `Agent_Compliance` | Compliance Screener | EU/GDPR + SOX | ACTIVE (Contract Signed) |
| `Nexus_Finance_Officer-{UUID}` | `Agent_FinancialOfficer` | Financial Officer | Token Budget & Cost Auditor | ACTIVE (Contract Signed) |

### Human Roles (Retained, Informed by Agents)

- **H-01: Chief Audit Executive** → Final sign-off on audit reports (human-in-the-loop)
- **H-02: Senior Compliance Officer** → Monitors GDPR/SOX regulatory changes; validates agent outputs

### Role-to-Agent Mapping (From Client Profile)

1. **Junior Data Analyst** → `Agent_Researcher` (`Nexus_Researcher`)
   - Replaces: "Manually scraping bank statements into Excel"
   - Workflow: WF-AUDIT-01 Steps 1-2 (Ingest & Normalize)

2. **Compliance Screener** → `Agent_Compliance` (`Nexus_Compliance`)
   - Replaces: "Checking transactions against watchlists"
   - Workflow: WF-AUDIT-01 Step 3 (Cross-reference Global_Sanctions_List.db)

3. **Audit Workflow Coordinator** → `Agent_ProjectManager` (`Nexus_PM`)
   - Replaces: "Assigning files to analysts and tracking deadlines"
   - Workflow: End-to-end coordination of WF-AUDIT-01 (Supervisor Pattern)

---

## B. EXACT MPC PROTOCOLS ASSIGNED FOR PII PROTECTION

### Compliance Agent: MPC Configuration

**Agent:** `Nexus_Compliance` (`Agent_Compliance`)  
**Security Class:** High  
**PII Sensitivity:** Personally Identifiable Information (names, IDs, transaction details)

#### Primary MPC Protocol: **Yao's Garbled Circuits (Yao-GC)**

**Rationale (Master Data Source 19):**
- **Protocol Type:** 2PC (Two-Party Computation)
- **Security Model:** Semi-Honest (with malicious extensions via Cut-and-Choose)
- **Performance:** Constant rounds (independent of circuit depth)
- **Use Case:** Boolean circuit evaluation for watchlist matching without revealing PII

**Implementation Details:**
- **Circuit Design:** Low-depth Boolean circuits for:
  - Transaction amount comparisons (`> $10k` flagging)
  - Watchlist membership checks (Global_Sanctions_List.db lookups)
  - GDPR/SOX policy rule evaluation
- **Optimization Techniques:**
  - **Half Gates:** Reduces AND gates to 2 ciphertexts (bandwidth optimal)
  - **FreeXOR:** XOR gates computed without ciphertexts (global key offset Δ)
  - **Garbled Row Reduction (GRR3):** Reduces transmitted ciphertexts per gate (4→3)

#### Secondary MPC Protocol: **GMW (Goldreich-Micali-Wigderson)**

**Rationale:**
- **Protocol Type:** Multi-party (supports 3+ parties if needed for distributed watchlists)
- **Security Model:** Semi-Honest
- **Use Case:** Additive secret sharing for aggregation of flagged transactions across multiple data sources
- **Performance Note:** Rounds scale with circuit depth (optimized via low-depth circuit design)

#### Malicious Security Extension: **Authenticated Secret Sharing (SPDZ-style)**

**When Activated:**
- If Compliance Agent detects potential adversarial behavior or collusion attempts
- For high-value transactions (> $100k) requiring strongest guarantees

**Protocol Details:**
- **Preprocessing Phase:** Generates Beaver multiplication triples offline
- **Online Phase:** Fast computation with authenticated shares
- **Security Model:** Malicious (strongest cryptographic guarantees)

#### Side-Channel Hardening (cb-mpc Audit Compliance)

**Enforced Constraints:**
- ✅ **Reject Variable-Time Crypto:** All modular inversions use constant-time algorithms
- ✅ **Enforce Group Membership Checks:** ECC points validated for prime-order subgroup (prevents Small Subgroup Attacks, CBS-02-004)
- ✅ **Deterministic Nonces:** Ed25519 signing uses deterministic nonces (prevents CBS-02-001)

#### MPC Data Flow for Compliance Agent

```
Raw Transaction Data (PII)
    ↓
[MPC Preprocessing: Secret Sharing]
    ↓
Yao-GC Circuit Execution (Watchlist Matching)
    ↓
[MPC Output: Flags Only (No PII Revealed)]
    ↓
Session Firewall Validation (C6 Protection)
    ↓
Provenance-Logged Results → Project Manager
```

**Privacy Guarantee:** Compliance Agent never sees raw names/IDs during processing. Only boolean flags (match/no-match) and aggregate statistics are revealed.

---

## C. TOKEN BUDGET ALLOCATION (Total: 500,000 tokens/month)

### Budget Distribution Strategy

| Agent | Role | Monthly Allocation | Justification | Penalty Threshold |
|-------|------|-------------------|---------------|-------------------|
| **Nexus_PM** | Project Manager | 100,000 tokens (20%) | Workflow decomposition, delegation, trust ledger management | Exceeds 100k → Contract review |
| **Nexus_Researcher** | Researcher | 200,000 tokens (40%) | Heavy MCP tool usage (PDF parsing, Excel writing, web search) | Exceeds 200k → Immediate halt |
| **Nexus_Compliance** | Compliance | 150,000 tokens (30%) | MPC computation overhead + watchlist queries | Exceeds 150k → Security audit |
| **Nexus_Finance_Officer** | Financial Officer | 50,000 tokens (10%) | Budget monitoring, reporting, cost analysis | Exceeds 50k → Escalation to human |

### Budget Enforcement Rules

1. **Per-Agent Ceilings:** Each agent's `token_budget_max` is set to their allocation above
2. **Cross-Agent Oversight:** `Nexus_Finance_Officer` monitors total swarm usage via `record_token_spend()`
3. **Penalty Clause (Client Mandate):** "Any data leak or hallucination regarding financial figures results in immediate contract termination"
4. **Trust Ledger Impact:** Token overruns reduce agent `trust_score` (affects future task assignments)

### Reserve Buffer

- **Unallocated Reserve:** 0 tokens (100% allocated for predictability)
- **Emergency Escalation:** If any agent exceeds allocation, `Nexus_Finance_Officer` triggers human review (H-01: Chief Audit Executive)

---

## D. INTEGRATION STRATEGY FOR 'WF-AUDIT-01' USING MCP TOOLS

### Workflow: Automated Transaction Audit

**Workflow ID:** `WF-AUDIT-01`  
**MCP Tools Required:** `MCP-PDF-Parser`, `MCP-Excel-Writer`, `MCP-Web-Search`

### Step-by-Step Agent Orchestration

#### Step 1: Ingest Raw Transaction Logs (PDF/CSV)
**Agent:** `Nexus_Researcher`  
**MCP Tool:** `MCP-PDF-Parser`  
**Action:**
```python
# Pseudo-code for MCP tool call
mcp_call = {
    "tool": "MCP-PDF-Parser",
    "params": {
        "input_file": "transaction_logs.pdf",
        "output_format": "structured_json",
        "mpc_mode": True  # PII remains encrypted during parsing
    }
}
```
**Output:** Normalized transaction data (PII-encrypted via MPC secret shares)

#### Step 2: Normalize Data Format
**Agent:** `Nexus_Researcher`  
**MCP Tool:** `MCP-Excel-Writer` (for intermediate storage)  
**Action:**
```python
mcp_call = {
    "tool": "MCP-Excel-Writer",
    "params": {
        "data": normalized_transactions,
        "template": "Nexus_Audit_Template.xlsx",
        "mpc_mode": True
    }
}
```
**Output:** Standardized transaction records ready for compliance screening

#### Step 3: Cross-Reference Against Global_Sanctions_List.db
**Agent:** `Nexus_Compliance`  
**MCP Tool:** `MCP-Web-Search` (for external watchlist queries if needed)  
**MPC Protocol:** **Yao's GC** (as detailed in Section B)  
**Action:**
```python
# MPC-encrypted watchlist matching
compliance_check = {
    "agent": "Nexus_Compliance",
    "mpc_protocol": "Yao-GC",
    "circuit": "watchlist_membership_check",
    "inputs": [encrypted_transaction_data, encrypted_watchlist],
    "output": "match_flags_only"  # No PII revealed
}
```
**Output:** Boolean flags indicating suspicious transactions (> $10k or watchlist matches)

#### Step 4: Flag Suspicious Outliers (> $10k)
**Agent:** `Nexus_Compliance`  
**MPC Protocol:** **Yao's GC** (threshold comparison circuit)  
**Action:**
- Circuit evaluates: `transaction_amount > 10000`
- Output: Flag vector (no amount values revealed to Compliance Agent)

#### Step 5: Generate Summary Report for Human Review
**Agent:** `Nexus_PM` (orchestrates) → `Nexus_Researcher` (writes report)  
**MCP Tool:** `MCP-Excel-Writer`  
**Action:**
```python
# Aggregated, anonymized report (no PII in final output)
report = {
    "workflow_id": "WF-AUDIT-01",
    "total_transactions_processed": aggregate_count,
    "suspicious_flags": flag_count,
    "compliance_status": "PASS" | "REVIEW_REQUIRED",
    "mpc_provenance_log": full_audit_trail  # C5: Full Provenance Tracking
}
```
**Output:** Excel report delivered to H-01 (Chief Audit Executive) for final sign-off

### MCP Tool Integration Architecture

```
┌─────────────────────────────────────────────────────────────┐
│                    MCP Server Layer                          │
├─────────────────────────────────────────────────────────────┤
│  MCP-PDF-Parser  │  MCP-Excel-Writer  │  MCP-Web-Search     │
└─────────────────────────────────────────────────────────────┘
         ↑                    ↑                    ↑
         │                    │                    │
    [MCP Client: Nexus_Researcher]              [MCP Client: Nexus_Compliance]
         │                    │                    │
         └────────────────────┴────────────────────┘
                              │
                    [A2A Protocol Bus]
                              │
         ┌────────────────────┴────────────────────┐
         │                                          │
    [Nexus_PM] (Supervisor)              [Nexus_Finance_Officer]
         │                                          │
         └──────────────────────────────────────────┘
                    [Trust Ledger & Budget Tracking]
```

### Session-Level Semantic Firewall (C6 Protection)

**Implementation:** All MCP tool calls are intercepted by the Session Firewall LLM, which:
1. Ingests the entire multi-agent dialogue in a sliding window
2. Detects when composite context breaches policy (e.g., PII reconstruction attempts)
3. Blocks or sanitizes queries that could lead to cross-domain context bypass

**Firewall Mode:** `Session-level Semantic Firewall` (from `swarm_protocols.py`)

### Provenance Tracking (C5: Cross-domain Provenance Obscurity)

**Requirement:** Full Provenance Tracking with neural provenance / audit logs

**Implementation:**
- Each agent embeds subtle signatures (watermarks) in generated content
- A decoder model reconstructs the timeline of contributions
- All MCP tool calls are logged with:
  - Agent ID
  - Timestamp
  - Input/output hashes (not raw data)
  - MPC protocol used
  - Trust score at time of execution

**Provenance Log Location:** `/factory_logs/nexus_provenance_audit.jsonl`

---

## E. DEPLOYMENT CHECKLIST

### Pre-Deployment
- [x] Client Profile ingested (`nexus_financial_assurance.json`)
- [x] Agents instantiated from Finance market catalogue
- [x] E-Contracts generated with MPC requirements
- [x] Token budgets allocated (500k total)
- [x] MCP tools configured (PDF-Parser, Excel-Writer, Web-Search)

### Security Validation
- [x] MPC protocols assigned (Yao-GC primary, GMW secondary, SPDZ for malicious)
- [x] Session Firewall enabled (C6 protection)
- [x] Side-channel hardening enforced (constant-time crypto, group checks)
- [x] Provenance tracking configured (C5 compliance)

### Contract Status
- [x] `Nexus_PM` → Contract `Nexus Financial Assurance Ltd.-PM-MASTER` (SIGNED)
- [x] `Nexus_Researcher` → Contract `Nexus Financial Assurance Ltd.-RES-01` (SIGNED)
- [x] `Nexus_Compliance` → Contract `Nexus Financial Assurance Ltd.-COMP-01` (SIGNED)
- [x] `Nexus_Finance_Officer` → Contract `Nexus Financial Assurance Ltd.-FIN-01` (SIGNED)

### Ready for Production
✅ **SWARM AGENCY STATUS: DEPLOYED & OPERATIONAL**

---

## F. REFERENCES

- **Master Data Source:** `Master Data for MAaaS.pdf` (file:///c%3A/Users/PC/MAaaS/Master%20Data%20for%20MAaaS.pdf)
- **MPC Protocols:** Source 19 (Yao's GC, GMW, BGW, SPDZ)
- **Security Challenges:** C5 (Provenance), C6 (Context Bypass)
- **cb-mpc Audit:** CBS-02-001, CBS-02-002, CBS-02-003, CBS-02-004, CBS-02-006
- **Base Agent Reference:** `catalogue/gent_ProjectManager.py`

---

**END OF DEPLOYMENT PLAN**

